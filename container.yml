arguments:
    handlers: map<string, callable>
    logger: '?Psr\Log\LoggerInterface'

expose:
    bus: $bus.default
    queue: $bus.queue
    logger: $bus.logger
    enqueue: $bus.enqueue
    dequeue: $bus.dequeue

services:
    bus:
        logger Innmind\CommandBus\LoggerCommandBus:
            - '@decorated'
            - '$logger'

        queue Innmind\CommandBus\QueueableCommandBus:
            - '@decorated'

        default Innmind\CommandBus\CommandBus:
            - '$handlers'

        enqueue Innmind\CommandBus\EnqueueCommandBus:
            - $queue

        dequeue Innmind\CommandBus\DequeueCommandBus:
            - '@decorated'
            - '$queue'

    queue Innmind\CommandBus\Queue: []
